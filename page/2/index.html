<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>菜菜的博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="菜菜的博客">
<meta property="og:type" content="website">
<meta property="og:title" content="菜菜的博客">
<meta property="og:url" content="http://yoursite.com/page/2/index.html">
<meta property="og:site_name" content="菜菜的博客">
<meta property="og:description" content="菜菜的博客">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="菜菜的博客">
<meta name="twitter:description" content="菜菜的博客">
  
    <link rel="alternative" href="/atom.xml" title="菜菜的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/ccz.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">菜菜</a></h1>
		</hgroup>

		
		<p class="header-subtitle">菜菜的博客</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						<li>Links</li>
						
						
						<li>Über</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
							<li><a href="/tags">标签</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/git/" style="font-size: 13.33px;">git</a> <a href="/tags/html5/" style="font-size: 10px;">html5</a> <a href="/tags/java/" style="font-size: 16.67px;">java</a> <a href="/tags/javascript/" style="font-size: 13.33px;">javascript</a> <a href="/tags/linux/" style="font-size: 10px;">linux</a> <a href="/tags/maven/" style="font-size: 10px;">maven</a> <a href="/tags/memcached/" style="font-size: 10px;">memcached</a> <a href="/tags/mongodb/" style="font-size: 10px;">mongodb</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/nginx/" style="font-size: 10px;">nginx</a> <a href="/tags/nodejs/" style="font-size: 10px;">nodejs</a> <a href="/tags/oracle/" style="font-size: 10px;">oracle</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/soa/" style="font-size: 20px;">soa</a> <a href="/tags/solr/" style="font-size: 10px;">solr</a> <a href="/tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="/tags/随笔/" style="font-size: 10px;">随笔</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">奥巴马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">卡卡的美丽传说</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">本泽马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">吉格斯的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">习大大大不同</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">托蒂的博客</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">菜菜</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="/img/ccz.jpg" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">菜菜</h1>
			</hgroup>
			
			<p class="header-subtitle">菜菜的博客</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
					<li><a href="/tags">标签</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-nginx内置变量大全" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/28/nginx内置变量大全/" class="article-date">
  	<time datetime="2016-04-29T00:19:21.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/nginx内置变量大全/">nginx内置变量大全</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>在配置基于nginx服务器的网站时，必然会用到 nginx内置变量 ，下面笔者将它整理成列表，把最新版本的变量列出来，以方便做配置时查询<br>nginx内置变量</p>
<p>内置变量存放在  ngx_http_core_module 模块中，变量的命名方式和apache 服务器变量是一致的。总而言之，这些变量代表着客户端请求头的内容，例如$http_user_agent, $http_cookie, 等等。下面是nginx支持的所有内置变量：<br>$arg_name<br>请求中的的参数名，即“?”后面的arg_name=arg_value形式的arg_name<br>$args<br>请求中的参数值<br>$binary_remote_addr<br>客户端地址的二进制形式, 固定长度为4个字节<br>$body_bytes_sent<br>传输给客户端的字节数，响应头不计算在内；这个变量和Apache的mod_log_config模块中的“%B”参数保持兼容<br>$bytes_sent<br>传输给客户端的字节数 (1.3.8, 1.2.5)<br>$connection<br>TCP连接的序列号 (1.3.8, 1.2.5)<br>$connection_requests<br>TCP连接当前的请求数量 (1.3.8, 1.2.5)<br>$content_length<br>“Content-Length” 请求头字段<br>$content_type<br>“Content-Type” 请求头字段<br>$cookie_name<br>cookie名称<br>$document_root<br>当前请求的文档根目录或别名<br>$document_uri<br>同 $uri<br>$host<br>优先级如下：HTTP请求行的主机名&gt;”HOST”请求头字段&gt;符合请求的服务器名<br>$hostname<br>主机名<br>$http_name<br>匹配任意请求头字段； 变量名中的后半部分“name”可以替换成任意请求头字段，如在配置文件中需要获取http请求头：“Accept-Language”，那么将“－”替换为下划线，大写字母替换为小写，形如：$http_accept_language即可。<br>$https<br>如果开启了SSL安全模式，值为“on”，否则为空字符串。<br>$is_args<br>如果请求中有参数，值为“?”，否则为空字符串。<br>$limit_rate<br>用于设置响应的速度限制，详见 limit_rate。<br>$msec<br>当前的Unix时间戳 (1.3.9, 1.2.6)<br>$nginx_version<br>nginx版本<br>$pid<br>工作进程的PID<br>$pipe<br>如果请求来自管道通信，值为“p”，否则为“.” (1.3.12, 1.2.7)<br>$proxy_protocol_addr<br>获取代理访问服务器的客户端地址，如果是直接访问，该值为空字符串。(1.5.12)<br>$query_string<br>同 $args<br>$realpath_root<br>当前请求的文档根目录或别名的真实路径，会将所有符号连接转换为真实路径。<br>$remote_addr<br>客户端地址<br>$remote_port<br>客户端端口<br>$remote_user<br>用于HTTP基础认证服务的用户名<br>$request<br>代表客户端的请求地址<br>$request_body<br>客户端的请求主体<br>此变量可在location中使用，将请求主体通过proxy_pass, fastcgi_pass, uwsgi_pass, 和 scgi_pass传递给下一级的代理服务器。<br>$request_body_file<br>将客户端请求主体保存在临时文件中。文件处理结束后，此文件需删除。如果需要之一开启此功能，需要设置client_body_in_file_only。如果将次文件传递给后端的代理服务器，需要禁用request body，即设置proxy_pass_request_body off，fastcgi_pass_request_body off, uwsgi_pass_request_body off, or scgi_pass_request_body off 。<br>$request_completion<br>如果请求成功，值为”OK”，如果请求未完成或者请求不是一个范围请求的最后一部分，则为空。<br>$request_filename<br>当前连接请求的文件路径，由root或alias指令与URI请求生成。<br>$request_length<br>请求的长度 (包括请求的地址, http请求头和请求主体) (1.3.12, 1.2.7)<br>$request_method<br>HTTP请求方法，通常为“GET”或“POST”<br>$request_time<br>处理客户端请求使用的时间 (1.3.9, 1.2.6); 从读取客户端的第一个字节开始计时。<br>$request_uri<br>这个变量等于包含一些客户端请求参数的原始URI，它无法修改，请查看$uri更改或重写URI，不包含主机名，例如：”/cnphp/test.php?arg=freemouse”。<br>$scheme<br>请求使用的Web协议, “http” 或 “https”<br>$sent_http_name<br>可以设置任意http响应头字段； 变量名中的后半部分“name”可以替换成任意响应头字段，如需要设置响应头Content-length，那么将“－”替换为下划线，大写字母替换为小写，形如：$sent_http_content_length 4096即可。<br>$server_addr<br>服务器端地址，需要注意的是：为了避免访问linux系统内核，应将ip地址提前设置在配置文件中。<br>$server_name<br>服务器名，www.cnphp.info<br>$server_port<br>服务器端口<br>$server_protocol<br>服务器的HTTP版本, 通常为 “HTTP/1.0” 或 “HTTP/1.1”<br>$status<br>HTTP响应代码 (1.3.2, 1.2.2)<br>$tcpinfo_rtt, $tcpinfo_rttvar, $tcpinfo_snd_cwnd, $tcpinfo_rcv_space<br>客户端TCP连接的具体信息<br>$time_iso8601<br>服务器时间的ISO 8610格式 (1.3.12, 1.2.7)<br>$time_local<br>服务器时间（LOG Format 格式） (1.3.12, 1.2.7)<br>$uri<br>请求中的当前URI(不带请求参数，参数位于$args)，可以不同于浏览器传递的$request_uri的值，它可以通过内部重定向，或者使用index指令进行修改，$uri不包含主机名，如”/foo/bar.html”。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx/">nginx</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-mysql主从同步" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/28/mysql主从同步/" class="article-date">
  	<time datetime="2016-04-29T00:18:13.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/mysql主从同步/">mysql主从同步</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>前提条件两个数据库并且局域网能够访问并且两个数据库的版本号要一致（msyql -V 查看mysql版本号）。<br>否则容易出现莫名错误不好处理。<br>1:主数据库141（10.10.39.101）下面称作master<br>2:从数据库142（10.10.49.90）下面称作slave</p>
<p>配置如下<br>1:在主服务器上,设置一个从数据库的账户,使用REPLICATION SLAVE赋予权限,如:<br>mysql&gt; GRANT REPLICATION SLAVE ON <em>.</em> TO ‘slave001’@’10.10.49.90’ IDENTIFIED BY ‘1qazZZR@WSX’;</p>
<p>2:修改主数据库的配置文件my.cnf,开启BINLOG，并设置server-id的值，修改之后必须重启Mysql服务<br>[mysqld]<br>log-bin = mysql-bin<br>server-id=141</p>
<p>3:之后可以得到主服务器当前二进制日志名和偏移量，这个操作的目的是为了在从数据库启动后，从这个<br>点开始进行数据的恢复<br>mysql&gt; show master status\G;<br><strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong> 1. row <strong><strong><strong><strong><strong><strong><em>*</em></strong></strong></strong></strong></strong></strong><br>File: mysql-bin.000003<br>Position: 243<br>Binlog_Do_DB:<br>Binlog_Ignore_DB:<br>1 row in set (0.00 sec)<br>4:停止对master数据库的更新然后导出需要同步的数据库，<br>mysql&gt; flush tables with read lock;<br>mysqldump -h127.0.0.1 -p3306 -uroot -p zzr &gt; /home/zzr.sql<br>mysql&gt; unlock tables;<br>5：将刚才主数据备份的zzr.sql复制到从数据库，进行导入<br>6：接着修改从数据库的my.cnf,增加server-id参数,指定复制使用的用户,主数据库服务器的ip,端口以及开始执<br>行复制日志的文件和位置<br>[mysqld]<br>server-id=142<br>log_bin = mysql-bin<br>master-host =10.10.39.101<br>master-user=slave001<br>master-pass=1qazZZR@WSX<br>master-port =20010<br>master-connect-retry=60<br>replicate-do-db =zzr,open<br>7:在从服务器上,启动slave进程<br>mysql&gt; start slave;<br>    如果启动失败：在slave上强制执行<br>    mysql&gt; change master to master_host=’master_host’, master_user=’you_user_name’, master_password=’you_master_user_password’,master_log_file=’mysqld-bin.000001’,master_port=3306, master_log_pos=98;<br>   （master_log_file和master_log_pos）的值你可以在服务器上运行 show master status; 来得到。<br>    然后 mysql&gt; start slave;启动slave进程<br>8:在从服务器进行show salve status验证<br>mysql&gt; SHOW SLAVE STATUS\G<br>9：检测一下。看看是否主从同步了。 </p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/">mysql</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Java操作MongoDB" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/28/Java操作MongoDB/" class="article-date">
  	<time datetime="2016-04-29T00:17:23.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/Java操作MongoDB/">Java操作MongoDB</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>MongoDB for Java】Java操作MongoDB</p>
<p>上一篇文章: <a href="http://www.cnblogs.com/hoojo/archive/2011/06/01/2066426.html介绍到了在MongoDB的控制台完成MongoDB的数据操作，通过前一篇文章我们对MongoDB有了全面的认识和理解。现在我们就用Java来操作MongoDB的数据。" target="_blank" rel="external">http://www.cnblogs.com/hoojo/archive/2011/06/01/2066426.html介绍到了在MongoDB的控制台完成MongoDB的数据操作，通过前一篇文章我们对MongoDB有了全面的认识和理解。现在我们就用Java来操作MongoDB的数据。</a></p>
<p>开发环境：<br>System：Windows<br>IDE：eclipse、MyEclipse 8<br>Database：mongoDB<br>开发依赖库：<br>JavaEE5、mongo-2.5.3.jar、junit-4.8.2.jar<br>Email：hoojo_@126.com<br>Blog：<a href="http://blog.csdn.net/IBM_hoojo" target="_blank" rel="external">http://blog.csdn.net/IBM_hoojo</a><br><a href="http://hoojo.cnblogs.com/" target="_blank" rel="external">http://hoojo.cnblogs.com/</a></p>
<p>一、准备工作</p>
<p>1、 首先，下载mongoDB对Java支持的驱动包<br>驱动包下载地址：<a href="https://github.com/mongodb/mongo-java-driver/downloads" target="_blank" rel="external">https://github.com/mongodb/mongo-java-driver/downloads</a><br>mongoDB对Java的相关支持、技术：<a href="http://www.mongodb.org/display/DOCS/Java+Language+Center" target="_blank" rel="external">http://www.mongodb.org/display/DOCS/Java+Language+Center</a><br>驱动源码下载：<a href="https://download.github.com/mongodb-mongo-java-driver-r2.6.1-7-g6037357.zip" target="_blank" rel="external">https://download.github.com/mongodb-mongo-java-driver-r2.6.1-7-g6037357.zip</a><br>在线查看源码：<a href="https://github.com/mongodb/mongo-java-driver" target="_blank" rel="external">https://github.com/mongodb/mongo-java-driver</a><br>2、 下面建立一个JavaProject工程，导入下载下来的驱动包。即可在Java中使用mongoDB，目录如下：</p>
<p>二、Java操作MongoDB示例</p>
<p>在本示例之前你需要启动mongod.exe的服务，启动后，下面的程序才能顺利执行；</p>
<p>1、 建立SimpleTest.java，完成简单的mongoDB数据库操作<br>Mongo mongo = new Mongo();<br>这样就创建了一个MongoDB的数据库连接对象，它默认连接到当前机器的localhost地址，端口是27017。<br>DB db = mongo.getDB(“test”);<br>这样就获得了一个test的数据库，如果mongoDB中没有创建这个数据库也是可以正常运行的。如果你读过上一篇文章就知道，mongoDB可以在没有创建这个数据库的情况下，完成数据的添加操作。当添加的时候，没有这个库，mongoDB会自动创建当前数据库。<br>得到了db，下一步我们要获取一个“聚集集合DBCollection”，通过db对象的getCollection方法来完成。<br>DBCollection users = db.getCollection(“users”);<br>这样就获得了一个DBCollection，它相当于我们数据库的“表”。<br>查询所有数据<br>DBCursor cur = users.find();<br>while (cur.hasNext()) {<br>System.out.println(cur.next());<br>}</p>
<p>完整源码<br>package com.hoo.test;</p>
<p>import java.net.UnknownHostException;<br>import com.mongodb.DB;<br>import com.mongodb.DBCollection;<br>import com.mongodb.DBCursor;<br>import com.mongodb.Mongo;<br>import com.mongodb.MongoException;<br>import com.mongodb.util.JSON;</p>
<p>/**</p>
<ul>
<li><b>function:</b>MongoDB 简单示例</li>
<li>@author hoojo</li>
<li>@createDate 2011-5-24 下午02:42:29</li>
<li>@file SimpleTest.java</li>
<li>@package com.hoo.test</li>
<li>@project MongoDB</li>
<li>@blog <a href="http://blog.csdn.net/IBM_hoojo" target="_blank" rel="external">http://blog.csdn.net/IBM_hoojo</a></li>
<li>@email hoojo_@126.com</li>
<li>@version 1.0<br>*/<br>publicclass SimpleTest {</li>
</ul>
<p>publicstaticvoid main(String[] args) throws UnknownHostException, MongoException {<br>        Mongo mg = new Mongo();<br>//查询所有的Database<br>for (String name : mg.getDatabaseNames()) {<br>            System.out.println(“dbName: “ + name);<br>        }<br>        DB db = mg.getDB(“test”);<br>//查询所有的聚集集合<br>for (String name : db.getCollectionNames()) {<br>            System.out.println(“collectionName: “ + name);<br>        }<br>        DBCollection users = db.getCollection(“users”);<br>//查询所有的数据<br>        DBCursor cur = users.find();<br>while (cur.hasNext()) {<br>            System.out.println(cur.next());<br>        }<br>        System.out.println(cur.count());<br>        System.out.println(cur.getCursorId());<br>        System.out.println(JSON.serialize(cur));<br>    }<br>}</p>
<p>2、 完成CRUD操作，首先建立一个MongoDB4CRUDTest.java，基本测试代码如下：<br>package com.hoo.test;</p>
<p>import java.net.UnknownHostException;<br>import java.util.ArrayList;<br>import java.util.List;<br>import org.bson.types.ObjectId;<br>import org.junit.After;<br>import org.junit.Before;<br>import org.junit.Test;<br>import com.mongodb.BasicDBObject;<br>import com.mongodb.Bytes;<br>import com.mongodb.DB;<br>import com.mongodb.DBCollection;<br>import com.mongodb.DBCursor;<br>import com.mongodb.DBObject;<br>import com.mongodb.Mongo;<br>import com.mongodb.MongoException;<br>import com.mongodb.QueryOperators;<br>import com.mongodb.util.JSON;</p>
<p>/**</p>
<ul>
<li><b>function:</b>实现MongoDB的CRUD操作</li>
<li>@author hoojo</li>
<li>@createDate 2011-6-2 下午03:21:23</li>
<li>@file MongoDB4CRUDTest.java</li>
<li>@package com.hoo.test</li>
<li>@project MongoDB</li>
<li>@blog <a href="http://blog.csdn.net/IBM_hoojo" target="_blank" rel="external">http://blog.csdn.net/IBM_hoojo</a></li>
<li>@email hoojo_@126.com</li>
<li>@version 1.0<br>*/<br>publicclass MongoDB4CRUDTest {<br>private Mongo mg = null;<br>private DB db;<br>private DBCollection users;<br> @Before<br>publicvoid init() {<br>try {<pre><code>mg = new Mongo();
</code></pre>//mg = new Mongo(“localhost”, 27017);<pre><code>} catch (UnknownHostException e) {
    e.printStackTrace();
} catch (MongoException e) {
    e.printStackTrace();
}
</code></pre>//获取temp DB；如果默认没有创建，mongodb会自动创建<pre><code>db = mg.getDB(&quot;temp&quot;);
</code></pre>//获取users DBCollection；如果默认没有创建，mongodb会自动创建<pre><code>users = db.getCollection(&quot;users&quot;);
</code></pre> }<br> @After<br>publicvoid destory() {<br>if (mg != null)<pre><code>    mg.close();
mg = null;
db = null;
users = null;
System.gc();
</code></pre> }<br>publicvoid print(Object o) {<pre><code>System.out.println(o);
</code></pre> }<br>}</li>
</ul>
<p>3、 添加操作<br>在添加操作之前，我们需要写个查询方法，来查询所有的数据。代码如下：<br>/**</p>
<ul>
<li><b>function:</b> 查询所有数据</li>
<li>@author hoojo</li>
<li>@createDate 2011-6-2 下午03:22:40<br>*/<br>privatevoid queryAll() {<br> print(“查询users的所有数据：”);<br>//db游标<br> DBCursor cur = users.find();<br>while (cur.hasNext()) {<pre><code>print(cur.next());
</code></pre> }<br>}</li>
</ul>
<p>@Test<br>publicvoid add() {<br>//先查询所有数据<br>    queryAll();<br>    print(“count: “ + users.count());<br>    DBObject user = new BasicDBObject();<br>    user.put(“name”, “hoojo”);<br>    user.put(“age”, 24);<br>//users.save(user)保存，getN()获取影响行数<br>//print(users.save(user).getN());<br>//扩展字段，随意添加字段，不影响现有数据<br>    user.put(“sex”, “男”);<br>    print(users.save(user).getN());<br>//添加多条数据，传递Array对象<br>    print(users.insert(user, new BasicDBObject(“name”, “tom”)).getN());<br>//添加List集合<br>    List<dbobject> list = new ArrayList<dbobject>();<br>    list.add(user);<br>    DBObject user2 = new BasicDBObject(“name”, “lucy”);<br>    user.put(“age”, 22);<br>    list.add(user2);<br>//添加List集合<br>    print(users.insert(list).getN());<br>//查询下数据，看看是否添加成功<br>    print(“count: “ + users.count());<br>    queryAll();<br>}</dbobject></dbobject></p>
<p>4、 删除数据<br>@Test<br>publicvoid remove() {<br>    queryAll();<br>    print(“删除id = 4de73f7acd812d61b4626a77：” + users.remove(new BasicDBObject(“_id”, new ObjectId(“4de73f7acd812d61b4626a77”))).getN());<br>    print(“remove age &gt;= 24: “ + users.remove(new BasicDBObject(“age”, new BasicDBObject(“$gte”, 24))).getN());<br>}</p>
<p>5、 修改数据<br>@Test<br>publicvoid modify() {<br>    print(“修改：” + users.update(new BasicDBObject(“_id”, new ObjectId(“4dde25d06be7c53ffbd70906”)), new BasicDBObject(“age”, 99)).getN());<br>    print(“修改：” + users.update(<br>new BasicDBObject(“_id”, new ObjectId(“4dde2b06feb038463ff09042”)),<br>new BasicDBObject(“age”, 121),<br>            true,//如果数据库不存在，是否添加<br>            false//多条修改<br>            ).getN());<br>    print(“修改：” + users.update(<br>new BasicDBObject(“name”, “haha”),<br>new BasicDBObject(“name”, “dingding”),<br>            true,//如果数据库不存在，是否添加<br>            true//false只修改第一天，true如果有多条就不修改<br>            ).getN());<br>//当数据库不存在就不修改、不添加数据，当多条数据就不修改<br>//print(“修改多条：” + coll.updateMulti(new BasicDBObject(“_id”, new ObjectId(“4dde23616be7c19df07db42c”)), new BasicDBObject(“name”, “199”)));<br>}</p>
<p>6、 查询数据<br>@Test<br>publicvoid query() {<br>//查询所有<br>//queryAll();<br>//查询id = 4de73f7acd812d61b4626a77<br>    print(“find id = 4de73f7acd812d61b4626a77: “ + users.find(new BasicDBObject(“_id”, new ObjectId(“4de73f7acd812d61b4626a77”))).toArray());<br>//查询age = 24<br>    print(“find age = 24: “ + users.find(new BasicDBObject(“age”, 24)).toArray());<br>//查询age &gt;= 24<br>    print(“find age &gt;= 24: “ + users.find(new BasicDBObject(“age”, new BasicDBObject(“$gte”, 24))).toArray());<br>    print(“find age &lt;= 24: “ + users.find(new BasicDBObject(“age”, new BasicDBObject(“$lte”, 24))).toArray());<br>    print(“查询age!=25：” + users.find(new BasicDBObject(“age”, new BasicDBObject(“$ne”, 25))).toArray());<br>    print(“查询age in 25/26/27：” + users.find(new BasicDBObject(“age”, new BasicDBObject(QueryOperators.IN, newint[] { 25, 26, 27 }))).toArray());<br>    print(“查询age not in 25/26/27：” + users.find(new BasicDBObject(“age”, new BasicDBObject(QueryOperators.NIN, newint[] { 25, 26, 27 }))).toArray());<br>    print(“查询age exists 排序：” + users.find(new BasicDBObject(“age”, new BasicDBObject(QueryOperators.EXISTS, true))).toArray());<br>    print(“只查询age属性：” + users.find(null, new BasicDBObject(“age”, true)).toArray());<br>    print(“只查属性：” + users.find(null, new BasicDBObject(“age”, true), 0, 2).toArray());<br>    print(“只查属性：” + users.find(null, new BasicDBObject(“age”, true), 0, 2, Bytes.QUERYOPTION_NOTIMEOUT).toArray());<br>//只查询一条数据，多条去第一条<br>    print(“findOne: “ + users.findOne());<br>    print(“findOne: “ + users.findOne(new BasicDBObject(“age”, 26)));<br>    print(“findOne: “ + users.findOne(new BasicDBObject(“age”, 26), new BasicDBObject(“name”, true)));<br>//查询修改、删除<br>    print(“findAndRemove 查询age=25的数据，并且删除: “ + users.findAndRemove(new BasicDBObject(“age”, 25)));<br>//查询age=26的数据，并且修改name的值为Abc<br>    print(“findAndModify: “ + users.findAndModify(new BasicDBObject(“age”, 26), new BasicDBObject(“name”, “Abc”)));<br>    print(“findAndModify: “ + users.findAndModify(<br>new BasicDBObject(“age”, 28), //查询age=28的数据<br>new BasicDBObject(“name”, true), //查询name属性<br>new BasicDBObject(“age”, true), //按照age排序<br>        false, //是否删除，true表示删除<br>new BasicDBObject(“name”, “Abc”), //修改的值，将name修改成Abc<br>        true,<br>        true));<br>    queryAll();<br>}<br>mongoDB不支持联合查询、子查询，这需要我们自己在程序中完成。将查询的结果集在Java查询中进行需要的过滤即可。</p>
<p>7、 其他操作<br>publicvoid testOthers() {<br>    DBObject user = new BasicDBObject();<br>    user.put(“name”, “hoojo”);<br>    user.put(“age”, 24);<br>//JSON 对象转换<br>    print(“serialize: “ + JSON.serialize(user));<br>//反序列化<br>    print(“parse: “ + JSON.parse(“{ \”name\” : \”hoojo\” , \”age\” : 24}”));<br>    print(“判断temp Collection是否存在: “ + db.collectionExists(“temp”));<br>//如果不存在就创建<br>if (!db.collectionExists(“temp”)) {<br>        DBObject options = new BasicDBObject();<br>        options.put(“size”, 20);<br>        options.put(“capped”, 20);<br>        options.put(“max”, 20);<br>        print(db.createCollection(“account”, options));<br>    }<br>//设置db为只读<br>    db.setReadOnly(true);<br>//只读不能写入数据<br>    db.getCollection(“test”).save(user);<br>}</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mongodb/">mongodb</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-memcache安装及配置" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/28/memcache安装及配置/" class="article-date">
  	<time datetime="2016-04-29T00:16:27.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/memcache安装及配置/">memcache安装及配置</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>CentOS6.4安装Memcached与使用例子</p>
<p>1、安装libevent<br>    wget <a href="http://monkey.org/~provos/libevent-1.4.14b-stable.tar.gz" target="_blank" rel="external">http://monkey.org/~provos/libevent-1.4.14b-stable.tar.gz</a><br>    tar zxvf libevent-1.4.14b-stable.tar.gz<br>    cd libevent-1.4.14b-stable<br>    ./configure –prefix=/usr/local/libevent/<br>    make &amp;&amp; make install<br>    ln -s /usr/local/libevent/lib/libevent-1.4.so.2 /lib/libevent-1.4.so.2<br>   /**<br>      1) 如果共享库文件安装到了/lib或/usr/lib目录下, 那么需执行一下ldconfig命令</p>
<p>ldconfig命令的用途, 主要是在默认搜寻目录(/lib和/usr/lib)以及动态库配置文件/etc/ld.so.conf内所列的目录下, 搜索出可共享的动态链接库(格式如lib<em>.so</em>), 进而创建出动态装入程序(ld.so)所需的连接和缓存文件. 缓存文件默认为/etc/ld.so.cache, 此文件保存已排好序的动态链接库名字列表. </p>
<p>2) 如果共享库文件安装到了/usr/local/lib(很多开源的共享库都会安装到该目录下)或其它”非/lib或/usr/lib”目录下, 那么在执行ldconfig命令前, 还要把新共享库目录加入到共享库配置文件/etc/ld.so.conf中, 如下:</p>
<h1 id="cat-etc-ld-so-conf"><a href="#cat-etc-ld-so-conf" class="headerlink" title="cat /etc/ld.so.conf"></a>cat /etc/ld.so.conf</h1><p>include ld.so.conf.d/*.conf</p>
<h1 id="echo-“-usr-local-lib”-gt-gt-etc-ld-so-conf"><a href="#echo-“-usr-local-lib”-gt-gt-etc-ld-so-conf" class="headerlink" title="echo “/usr/local/lib” &gt;&gt; /etc/ld.so.conf"></a>echo “/usr/local/lib” &gt;&gt; /etc/ld.so.conf</h1><h1 id="ldconfig"><a href="#ldconfig" class="headerlink" title="ldconfig"></a>ldconfig</h1><p>3) 如果共享库文件安装到了其它”非/lib或/usr/lib” 目录下,  但是又不想在/etc/ld.so.conf中加路径(或者是没有权限加路径). 那可以export一个全局变量LD_LIBRARY_PATH, 然后运行程序的时候就会去这个目录中找共享库. </p>
<p>LD_LIBRARY_PATH的意思是告诉loader在哪些目录中可以找到共享库. 可以设置多个搜索目录, 这些目录之间用冒号分隔开. 比如安装了一个mysql到/usr/local/mysql目录下, 其中有一大堆库文件在/usr/local/mysql/lib下面, 则可以在.bashrc或.bash_profile或shell里加入以下语句即可:</p>
<p>export LD_LIBRARY_PATH=/usr/local/mysql/lib:$LD_LIBRARY_PATH    </p>
<p>一般来讲这只是一种临时的解决方案, 在没有权限或临时需要的时候使用.</p>
<p>4）如果程序需要的库文件比系统目前存在的村文件版本低，可以做一个链接<br>比如：<br>error while loading shared libraries: libncurses.so.4: cannot open shared<br>object file: No such file or directory</p>
<p>ls /usr/lib/libncu*<br>/usr/lib/libncurses.a   /usr/lib/libncurses.so.5<br>/usr/lib/libncurses.so  /usr/lib/libncurses.so.5.3</p>
<p>可见虽然没有libncurses.so.4，但有libncurses.so.5，是可以向下兼容的<br>建一个链接就好了<br>ln -s  /usr/lib/libncurses.so.5.3  /usr/lib/libncurses.so.4</p>
<p>**/</p>
<p>2、安装Memcached<br>    wget <a href="http://www.danga.com/memcached/dist/memcached-1.2.0.tar.gz" target="_blank" rel="external">http://www.danga.com/memcached/dist/memcached-1.2.0.tar.gz</a><br>    tar zxvf memcached-1.4.15.tar.gz<br>    cd memcached-1.4.15<br>    ./configure –prefix=/usr/local/memcached/ –with-libevent=/usr/local/libevent/<br>    make &amp;&amp; make install<br>3、启动Memcached<br>     /usr/local/memcached/bin/memcached -d -m 64 -u root -l 127.0.0.100 -p 11211 -c 128 -P /tmp/memcached.pid<br>4、为了方便管理，写个SHELL脚本吧。</p>
<p> vi /etc/rc.d/init.d/memcached</p>
<pre><code>#!/bin/sh
#
# memcached: MemCached Daemon
#
# chkconfig: - 90 25
# description: MemCached Daemon
#
# Source function library.
. /etc/rc.d/init.d/functions
. /etc/sysconfig/network
#[ ${NETWORKING} = &quot;no&quot; ] &amp;&amp; exit 0
#[ -r /etc/sysconfig/dund ] || exit 0
#. /etc/sysconfig/dund
#[ -z &quot;$DUNDARGS&quot; ] &amp;&amp; exit 0
start()
{
echo -n $&quot;Starting memcached: &quot;
daemon $MEMCACHED -u daemon -d -m 64 -l 127.0.0.100 -p 11211 -c 128 -P /tmp/memcached.pid
echo
}
stop()
{
echo -n $&quot;Shutting down memcached: &quot;
killproc memcached
echo
}
MEMCACHED=&quot;/usr/local/memcached/bin/memcached&quot;
[ -f $MEMCACHED ] || exit 1
# See how we were called.
case &quot;$1&quot; in
start)
start
;;
stop)
stop
;;
restart)
stop
sleep 3
start
;;
*)
echo $&quot;Usage: $0 {start|stop|restart}&quot;
exit 1
esac
exit 0
</code></pre><p>5、添加Memcached开机启动<br>    cd /etc/rc.d/init.d/<br>    chmod 777 memcached<br>    chkconfig –add memcached<br>    chkconfig –level 235 memcached on<br>    chkconfig –list | grep memcached<br>6、Memcached使用<br>    [root@www.111cn.net] service memcached start<br>    [root@www.111cn.net] service memcached stop<br>    [root@www.111cn.net] service memcached restart</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/memcached/">memcached</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-redis的图形化工具" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/28/redis的图形化工具/" class="article-date">
  	<time datetime="2016-04-29T00:15:35.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/redis的图形化工具/">redis的图形化工具</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>redis的图形化工具</p>
<p>2015-10-29 Rails365 运维帮</p>
<ol>
<li>介绍</li>
</ol>
<p>本篇会介绍几个关于redis的图形化的监控工具和管理工具。</p>
<ol>
<li>redis-stat</li>
</ol>
<p>redis-stat（<a href="https://github.com/junegunn/redis-stat）提供终端和web端的监控页面，它安装和使用起来很简单。" target="_blank" rel="external">https://github.com/junegunn/redis-stat）提供终端和web端的监控页面，它安装和使用起来很简单。</a></p>
<p>安装只需要一条指令。</p>
<p>$ gem install redis-stat</p>
<p>运行更简单。</p>
<p>$ redis-stat</p>
<p>效果图如下：</p>
<p>也可以以server的形式运行，默认情况下是监听在63790端口。</p>
<p>$ redis-stat –server</p>
<p>还可以以后台进程的形式开启服务。</p>
<p>redis-stat –server –daemon</p>
<p>效果图如下：</p>
<ol>
<li>redis-browser</li>
</ol>
<p>redis-browser（<a href="https://github.com/monterail/redis-browser）是redis的web端的图形化管理工具。利用它可以查看和管理redis的数据，界面很简洁，安装和使用这个工具也比较简单，而且它还能和rails应用结合在一起。" target="_blank" rel="external">https://github.com/monterail/redis-browser）是redis的web端的图形化管理工具。利用它可以查看和管理redis的数据，界面很简洁，安装和使用这个工具也比较简单，而且它还能和rails应用结合在一起。</a></p>
<p>安装。</p>
<p>$ gem install redis-browser</p>
<p>要使用也只是需要一条命令。</p>
<p>$ redis-browser</p>
<p>效果图如下:</p>
<ol>
<li>redmon</li>
</ol>
<p>redmon也是一个监控redis运行情况的页面监控工具。</p>
<p>安装。</p>
<p>$ gem install redmon</p>
<p>使用。</p>
<p>$ redmon</p>
<p>效果图如下：</p>
<p>完结。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/">redis</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-maven常用命令" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/28/maven常用命令/" class="article-date">
  	<time datetime="2016-04-29T00:14:54.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/maven常用命令/">maven常用命令</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>maven 全球中心仓库 <a href="http://mirrors.ibiblio.org/maven2/org/apache/" target="_blank" rel="external">http://mirrors.ibiblio.org/maven2/org/apache/</a></p>
<p>Sonatype Nexus 搭建Maven 私服</p>
<p>mvn -v 查看版本<br>mvn compile 编译<br>mvn test 测试<br>mvn clean 清楚编译文件<br>mvn package 把项目打成jar包<br>mvn install 导入<br>mvn archetype:generate 更换本地仓库后下载maven骨架</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/maven/">maven</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="scp-远程免密码copy文件" class="article article-type-scp" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/28/远程免密码copy文件/" class="article-date">
  	<time datetime="2016-04-29T00:13:48.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/远程免密码copy文件/">远程免密码copy文件</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>1.先安装expect<br>yum -y install expect<br>2.脚本内容:<br>cat auto_svn.sh</p>
<p>#!/bin/bash<br>passwd=’123456’<br>/usr/bin/expect &lt;&lt;-EOF<br>set time 30<br>spawn ssh -p18330 root@192.168.10.22<br>expect {<br>“<em>yes/no” { send “yes＼r”; exp_continue }<br>“</em>password:” { send “$passwd＼r” }<br>}<br>expect “<em>#”<br>send “cd /home/trunk＼r”<br>expect “</em>#”<br>send “svn up＼r”<br>expect “*#”<br>send “exit＼r”<br>interact<br>expect eof<br>EOF</p>
<p>expect的简单用法及举例</p>
<p>#!/usr/bin/expect -f<br>set password 123456</p>
<p>#download<br>spawn scp root@192.168.1.218:/root/a.wmv /home/yangyz/<br>set timeout 300<br>expect “root@192.168.1.218’s password:”<br>set timeout 300<br>send “$passwordr”<br>set timeout 300<br>send “exitr”<br>expect eof</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/">linux</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-javascript-闭包" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/28/javascript-闭包/" class="article-date">
  	<time datetime="2016-04-29T00:13:02.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/javascript-闭包/">javascript----闭包</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>包</p>
<p>阅读: 9165<br>函数作为返回值</p>
<p>高阶函数除了可以接受函数作为参数外，还可以把函数作为结果值返回。<br>我们来实现一个对Array的求和。通常情况下，求和的函数是这样定义的：<br>functionsum(arr) {return arr.reduce(function(x, y) {return x + y;<br>    });<br>}</p>
<p>sum([1, 2, 3, 4, 5]); // 15<br>但是，如果不需要立刻求和，而是在后面的代码中，根据需要再计算怎么办？可以不返回求和的结果，而是返回求和的函数！<br>functionlazy_sum(arr) {var sum = function() {return arr.reduce(function(x, y) {return x + y;<br>        });<br>    }<br>    return sum;<br>}<br>当我们调用lazy_sum()时，返回的并不是求和结果，而是求和函数：<br>var f = lazy_sum([1, 2, 3, 4, 5]); // function sum()<br>调用函数f时，才真正计算求和的结果：<br>f(); //15<br>在这个例子中，我们在函数lazy_sum中又定义了函数sum，并且，内部函数sum可以引用外部函数lazy_sum的参数和局部变量，当lazy_sum返回函数sum时，相关参数和变量都保存在返回的函数中，这种称为“闭包（Closure）”的程序结构拥有极大的威力。<br>请再注意一点，当我们调用lazy_sum()时，每次调用都会返回一个新的函数，即使传入相同的参数：<br>var f1 = lazy_sum([1, 2, 3, 4, 5]);<br>var f2 = lazy_sum([1, 2, 3, 4, 5]);<br>f1 === f2; // false<br>f1()和f2()的调用结果互不影响。<br>闭包</p>
<p>注意到返回的函数在其定义内部引用了局部变量arr，所以，当一个函数返回了一个函数后，其内部的局部变量还被新函数引用，所以，闭包用起来简单，实现起来可不容易。<br>另一个需要注意的问题是，返回的函数并没有立刻执行，而是直到调用了f()才执行。我们来看一个例子：<br>functioncount() {var arr = [];<br>    for (var i=1; i&lt;=3; i++) {<br>        arr.push(function() {return i * i;<br>        });<br>    }<br>    return arr;<br>}</p>
<p>var results = count();<br>var f1 = results[0];<br>var f2 = results[1];<br>var f3 = results[2];<br>在上面的例子中，每次循环，都创建了一个新的函数，然后，把创建的3个函数都添加到一个Array中返回了。<br>你可能认为调用f1()，f2()和f3()结果应该是1，4，9，但实际结果是：<br>f1(); //16<br>f2(); //16<br>f3(); //16<br>全部都是16！原因就在于返回的函数引用了变量i，但它并非立刻执行。等到3个函数都返回时，它们所引用的变量i已经变成了4，因此最终结果为16。<br>返回闭包时牢记的一点就是：返回函数不要引用任何循环变量，或者后续会发生变化的变量。<br>如果一定要引用循环变量怎么办？方法是再创建一个函数，用该函数的参数绑定循环变量当前的值，无论该循环变量后续如何更改，已绑定到函数参数的值不变：<br>functioncount() {var arr = [];<br>    for (var i=1; i&lt;=3; i++) {<br>        arr.push((function(n) {returnfunction() {return n * n;<br>            }<br>        })(i));<br>    }<br>    return arr;<br>}</p>
<p>var results = count();<br>var f1 = results[0];<br>var f2 = results[1];<br>var f3 = results[2];</p>
<p>f1(); // 1<br>f2(); // 4<br>f3(); // 9<br>注意这里用了一个“创建一个匿名函数并立刻执行”的语法：<br>(function(x) {return x <em> x;<br>})(3); // 9<br>理论上讲，创建一个匿名函数并立刻执行可以这么写：<br>function(x) {return x </em> x } (3);<br>但是由于JavaScript语法解析的问题，会报SyntaxError错误，因此需要用括号把整个函数定义括起来：<br>(function(x) {return x <em> x }) (3);<br>通常，一个立即执行的匿名函数可以把函数体拆开，一般这么写：<br>(function(x) {return x </em> x;<br>})(3);<br>说了这么多，难道闭包就是为了返回一个函数然后延迟执行吗？<br>当然不是！闭包有非常强大的功能。举个栗子：<br>在面向对象的程序设计语言里，比如Java和C++，要在对象内部封装一个私有变量，可以用private修饰一个成员变量。<br>在没有class机制，只有函数的语言里，借助闭包，同样可以封装一个私有变量。我们用JavaScript创建一个计数器：<br>‘use strict’;</p>
<p>functioncreate_counter(initial) {var x = initial || 0;<br>    return {<br>        inc: function() {<br>            x += 1;<br>            return x;<br>        }<br>    }<br>}<br>它用起来像这样：<br>var c1 = create_counter();<br>c1.inc(); // 1<br>c1.inc(); // 2<br>c1.inc(); // 3var c2 = create_counter(10);<br>c2.inc(); // 11<br>c2.inc(); // 12<br>c2.inc(); // 13<br>在返回的对象中，实现了一个闭包，该闭包携带了局部变量x，并且，从外部代码根本无法访问到变量x。换句话说，闭包就是携带状态的函数，并且它的状态可以完全对外隐藏起来。<br>闭包还可以把多参数的函数变成单参数的函数。例如，要计算xy可以用Math.pow(x, y)函数，不过考虑到经常计算x2或x3，我们可以利用闭包创建新的函数pow2和pow3：<br>functionmake_pow(n) {returnfunction(x) {return Math.pow(x, n);<br>    }<br>}</p>
<p>// 创建两个新函数:var pow2 = make_pow(2);<br>var pow3 = make_pow(3);</p>
<p>pow2(5); // 25<br>pow3(7); // 343<br>脑洞大开</p>
<p>很久很久以前，有个叫阿隆佐·邱奇的帅哥，发现只需要用函数，就可以用计算机实现运算，而不需要0、1、2、3这些数字和+、-、*、/这些符号。<br>JavaScript支持函数，所以可以用JavaScript用函数来写这些计算。来试试：<br>‘use strict’;</p>
<p>// 定义数字0:<br>var zero = function (f) {<br>    return function (x) {<br>        return x;<br>    }<br>};</p>
<p>// 定义数字1:<br>var one = function (f) {<br>    return function (x) {<br>        return f(x);<br>    }<br>};</p>
<p>// 定义加法:<br>function add(n, m) {<br>    return function (f) {<br>        return function (x) {<br>            return m(f)(n(f)(x));<br>        }<br>    }<br>}</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-HTjavascript-正则表达式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/28/HTjavascript-正则表达式/" class="article-date">
  	<time datetime="2016-04-29T00:10:23.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/HTjavascript-正则表达式/">javascript---正则表达式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>gExp</p>
<p>阅读: 1981<br>字符串是编程时涉及到的最多的一种数据结构，对字符串进行操作的需求几乎无处不在。比如判断一个字符串是否是合法的Email地址，虽然可以编程提取@前后的子串，再分别判断是否是单词和域名，但这样做不但麻烦，而且代码难以复用。<br>正则表达式是一种用来匹配字符串的强有力的武器。它的设计思想是用一种描述性的语言来给字符串定义一个规则，凡是符合规则的字符串，我们就认为它“匹配”了，否则，该字符串就是不合法的。<br>所以我们判断一个字符串是否是合法的Email的方法是：<br>创建一个匹配Email的正则表达式；<br>用该正则表达式去匹配用户的输入来判断是否合法。<br>因为正则表达式也是用字符串表示的，所以，我们要首先了解如何用字符来描述字符。<br>在正则表达式中，如果直接给出字符，就是精确匹配。用\d可以匹配一个数字，\w可以匹配一个字母或数字，所以：<br>‘00\d’可以匹配’007’，但无法匹配’00A’；<br>‘\d\d\d’可以匹配’010’；<br>‘\w\w’可以匹配’js’；<br>.可以匹配任意字符，所以：<br>‘js.’可以匹配’jsp’、’jss’、’js!’等等。<br>要匹配变长的字符，在正则表达式中，用*表示任意个字符（包括0个），用+表示至少一个字符，用?表示0个或1个字符，用{n}表示n个字符，用{n,m}表示n-m个字符：<br>来看一个复杂的例子：\d{3}\s+\d{3,8}。<br>我们来从左到右解读一下：<br>\d{3}表示匹配3个数字，例如’010’；<br>\s可以匹配一个空格（也包括Tab等空白符），所以\s+表示至少有一个空格，例如匹配’ ‘，’\t\t’等；<br>\d{3,8}表示3-8个数字，例如’1234567’。<br>综合起来，上面的正则表达式可以匹配以任意个空格隔开的带区号的电话号码。<br>如果要匹配’010-12345’这样的号码呢？由于’-‘是特殊字符，在正则表达式中，要用’\’转义，所以，上面的正则是\d{3}-\d{3,8}。<br>但是，仍然无法匹配’010 - 12345’，因为带有空格。所以我们需要更复杂的匹配方式。<br>进阶</p>
<p>要做更精确地匹配，可以用[]表示范围，比如：<br>[0-9a-zA-Z_]可以匹配一个数字、字母或者下划线；<br>[0-9a-zA-Z_]+可以匹配至少由一个数字、字母或者下划线组成的字符串，比如’a100’，’0<em>Z’，’js2015’等等；<br>[a-zA-Z\</em>\$][0-9a-zA-Z_\$]*可以匹配由字母或下划线、$开头，后接任意个由一个数字、字母或者下划线、$组成的字符串，也就是JavaScript允许的变量名；<br>[a-zA-Z_\$][0-9a-zA-Z_\$]{0, 19}更精确地限制了变量的长度是1-20个字符（前面1个字符+后面最多19个字符）。<br>A|B可以匹配A或B，所以[J|j]ava[S|s]cript可以匹配’JavaScript’、’Javascript’、’javaScript’或者’javascript’。<br>^表示行的开头，^\d表示必须以数字开头。<br>$表示行的结束，\d$表示必须以数字结束。<br>你可能注意到了，js也可以匹配’jsp’，但是加上^js$就变成了整行匹配，就只能匹配’js’了。<br>RegExp</p>
<p>有了准备知识，我们就可以在JavaScript中使用正则表达式了。<br>JavaScript有两种方式创建一个正则表达式：<br>第一种方式是直接通过/正则表达式/写出来，第二种方式是通过new RegExp(‘正则表达式’)创建一个RegExp对象。<br>两种写法是一样的：<br>var re1 = /ABC-001/;<br>var re2 = new RegExp(‘ABC\-001’);</p>
<p>re1; // /ABC-001/<br>re2; // /ABC-001/<br>注意，如果使用第二种写法，因为字符串的转义问题，字符串的两个\实际上是一个\。<br>先看看如何判断正则表达式是否匹配：<br>var re = /^\d{3}-\d{3,8}$/;<br>re.test(‘010-12345’); //true<br>re.test(‘010-1234x’); //false<br>re.test(‘010 12345’); //false<br>RegExp对象的test()方法用于测试给定的字符串是否符合条件。<br>切分字符串</p>
<p>用正则表达式切分字符串比用固定的字符更灵活，请看正常的切分代码：<br>‘a b   c’.split(‘ ‘); // [‘a’, ‘b’, ‘’, ‘’, ‘c’]<br>嗯，无法识别连续的空格，用正则表达式试试：<br>‘a b   c’.split(/\s+/); // [‘a’, ‘b’, ‘c’]<br>无论多少个空格都可以正常分割。加入,试试：<br>‘a,b, c  d’.split(/[\s\,]+/); // [‘a’, ‘b’, ‘c’, ‘d’]<br>再加入;试试：<br>‘a,b;; c  d’.split(/[\s\,\;]+/); // [‘a’, ‘b’, ‘c’, ‘d’]<br>如果用户输入了一组标签，下次记得用正则表达式来把不规范的输入转化成正确的数组。<br>分组</p>
<p>除了简单地判断是否匹配之外，正则表达式还有提取子串的强大功能。用()表示的就是要提取的分组（Group）。比如：<br>^(\d{3})-(\d{3,8})$分别定义了两个组，可以直接从匹配的字符串中提取出区号和本地号码：<br>var re = /^(\d{3})-(\d{3,8})$/;<br>re.exec(‘010-12345’); // [‘010-12345’, ‘010’, ‘12345’]<br>re.exec(‘010 12345’); // null<br>如果正则表达式中定义了组，就可以在RegExp对象上用exec()方法提取出子串来。<br>exec()方法在匹配成功后，会返回一个Array，第一个元素始终是原始字符串本身，后面的字符串表示匹配成功的子串。<br>exec()方法在匹配失败时返回null。<br>提取子串非常有用。来看一个更凶残的例子：<br>var re = /^(0[0-9]|1[0-9]|2[0-3]|[0-9])\:(0[0-9]|1[0-9]|2[0-9]|3[0-9]|4[0-9]|5[0-9]|[0-9])\:(0[0-9]|1[0-9]|2[0-9]|3[0-9]|4[0-9]|5[0-9]|[0-9])$/;<br>re.exec(‘19:05:30’); // [‘19:05:30’, ‘19’, ‘05’, ‘30’]<br>这个正则表达式可以直接识别合法的时间。但是有些时候，用正则表达式也无法做到完全验证，比如识别日期：<br>var re = /^(0[1-9]|1[0-2]|[0-9])-(0[1-9]|1[0-9]|2[0-9]|3[0-1]|[0-9])$/;<br>对于’2-30’，’4-31’这样的非法日期，用正则还是识别不了，或者说写出来非常困难，这时就需要程序配合识别了。<br>贪婪匹配</p>
<p>需要特别指出的是，正则匹配默认是贪婪匹配，也就是匹配尽可能多的字符。举例如下，匹配出数字后面的0：<br>var re = /^(\d+)(0<em>)$/;<br>re.exec(‘102300’); // [‘102300’, ‘102300’, ‘’]<br>由于\d+采用贪婪匹配，直接把后面的0全部匹配了，结果0</em>只能匹配空字符串了。<br>必须让\d+采用非贪婪匹配（也就是尽可能少匹配），才能把后面的0匹配出来，加个?就可以让\d+采用非贪婪匹配：<br>var re = /^(\d+?)(0*)$/;<br>re.exec(‘102300’); // [‘102300’, ‘1023’, ‘00’]<br>全局搜索</p>
<p>JavaScript的正则表达式还有几个特殊的标志，最常用的是g，表示全局匹配：<br>var r1 = /test/g;<br>// 等价于:var r2 = new RegExp(‘test’, ‘g’);<br>全局匹配可以多次执行exec()方法来搜索一个匹配的字符串。当我们指定g标志后，每次运行exec()，正则表达式本身会更新lastIndex属性，表示上次匹配到的最后索引：<br>var s = ‘JavaScript, VBScript, JScript and ECMAScript’;<br>var re=/[a-zA-Z]+Script/g;</p>
<p>// 使用全局匹配:<br>re.exec(s); // [‘JavaScript’]<br>re.lastIndex; // 10</p>
<p>re.exec(s); // [‘VBScript’]<br>re.lastIndex; // 20</p>
<p>re.exec(s); // [‘JScript’]<br>re.lastIndex; // 29</p>
<p>re.exec(s); // [‘ECMAScript’]<br>re.lastIndex; // 44</p>
<p>re.exec(s); // null，直到结束仍没有匹配到<br>全局匹配类似搜索，因此不能使用/^…$/，那样只会最多匹配一次。<br>正则表达式还可以指定i标志，表示忽略大小写，m标志，表示执行多行匹配。<br>小结</p>
<p>正则表达式非常强大，要在短短的一节里讲完是不可能的。要讲清楚正则的所有内容，可以写一本厚厚的书了。如果你经常遇到正则表达式的问题，你可能需要一本正则表达式的参考书。<br>练习</p>
<p>请尝试写一个验证Email地址的正则表达式。版本一应该可以验证出类似的Email：<br>‘use strict’;<br>// 测试:<br>var<br>    i,<br>    success = true,<br>    should_pass = [‘someone@gmail.com’, ‘bill.gates@microsoft.com’, ‘tom@voyager.org’, ‘bob2015@163.com’],<br>    should_fail = [‘test#gmail.com’, ‘bill@microsoft’, ‘bill%gates@ms.com’, ‘@voyager.org’];<br>for (i = 0; i &lt; should_pass.length; i++) {<br>    if (!re.test(should_pass[i])) {<br>        alert(‘测试失败: ‘ + should_pass[i]);<br>        success = false;<br>        break;<br>    }<br>}<br>for (i = 0; i &lt; should_fail.length; i++) {<br>    if (re.test(should_fail[i])) {<br>        alert(‘测试失败: ‘ + should_fail[i]);<br>        success = false;<br>        break;<br>    }<br>}<br>if (success) {<br>    alert(‘测试通过!’);<br>}<br>版本二可以验证并提取出带名字的Email地址：<br>‘use strict’;<br>// 测试:<br>var r = re.exec(‘<tom paris=""> tom@voyager.org’);<br>if (r === null || r.toString() !== [‘<tom paris=""> tom@voyager.org’, ‘Tom Paris’, ‘tom@voyager.org’].toString()) {<br>    alert(‘测试失败!’);<br>}<br>else {<br>    alert(‘测试成功!’);<br>}</tom></tom></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/javascript/">javascript</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-javascript-正则表达式" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/28/javascript-正则表达式/" class="article-date">
  	<time datetime="2016-04-29T00:10:23.000Z" itemprop="datePublished">2016-04-28</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/28/javascript-正则表达式/">javascript---正则表达式</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>gExp</p>
<p>阅读: 1981<br>字符串是编程时涉及到的最多的一种数据结构，对字符串进行操作的需求几乎无处不在。比如判断一个字符串是否是合法的Email地址，虽然可以编程提取@前后的子串，再分别判断是否是单词和域名，但这样做不但麻烦，而且代码难以复用。<br>正则表达式是一种用来匹配字符串的强有力的武器。它的设计思想是用一种描述性的语言来给字符串定义一个规则，凡是符合规则的字符串，我们就认为它“匹配”了，否则，该字符串就是不合法的。<br>所以我们判断一个字符串是否是合法的Email的方法是：<br>创建一个匹配Email的正则表达式；<br>用该正则表达式去匹配用户的输入来判断是否合法。<br>因为正则表达式也是用字符串表示的，所以，我们要首先了解如何用字符来描述字符。<br>在正则表达式中，如果直接给出字符，就是精确匹配。用\d可以匹配一个数字，\w可以匹配一个字母或数字，所以：<br>‘00\d’可以匹配’007’，但无法匹配’00A’；<br>‘\d\d\d’可以匹配’010’；<br>‘\w\w’可以匹配’js’；<br>.可以匹配任意字符，所以：<br>‘js.’可以匹配’jsp’、’jss’、’js!’等等。<br>要匹配变长的字符，在正则表达式中，用*表示任意个字符（包括0个），用+表示至少一个字符，用?表示0个或1个字符，用{n}表示n个字符，用{n,m}表示n-m个字符：<br>来看一个复杂的例子：\d{3}\s+\d{3,8}。<br>我们来从左到右解读一下：<br>\d{3}表示匹配3个数字，例如’010’；<br>\s可以匹配一个空格（也包括Tab等空白符），所以\s+表示至少有一个空格，例如匹配’ ‘，’\t\t’等；<br>\d{3,8}表示3-8个数字，例如’1234567’。<br>综合起来，上面的正则表达式可以匹配以任意个空格隔开的带区号的电话号码。<br>如果要匹配’010-12345’这样的号码呢？由于’-‘是特殊字符，在正则表达式中，要用’\’转义，所以，上面的正则是\d{3}-\d{3,8}。<br>但是，仍然无法匹配’010 - 12345’，因为带有空格。所以我们需要更复杂的匹配方式。<br>进阶</p>
<p>要做更精确地匹配，可以用[]表示范围，比如：<br>[0-9a-zA-Z_]可以匹配一个数字、字母或者下划线；<br>[0-9a-zA-Z_]+可以匹配至少由一个数字、字母或者下划线组成的字符串，比如’a100’，’0<em>Z’，’js2015’等等；<br>[a-zA-Z\</em>\$][0-9a-zA-Z_\$]*可以匹配由字母或下划线、$开头，后接任意个由一个数字、字母或者下划线、$组成的字符串，也就是JavaScript允许的变量名；<br>[a-zA-Z_\$][0-9a-zA-Z_\$]{0, 19}更精确地限制了变量的长度是1-20个字符（前面1个字符+后面最多19个字符）。<br>A|B可以匹配A或B，所以[J|j]ava[S|s]cript可以匹配’JavaScript’、’Javascript’、’javaScript’或者’javascript’。<br>^表示行的开头，^\d表示必须以数字开头。<br>$表示行的结束，\d$表示必须以数字结束。<br>你可能注意到了，js也可以匹配’jsp’，但是加上^js$就变成了整行匹配，就只能匹配’js’了。<br>RegExp</p>
<p>有了准备知识，我们就可以在JavaScript中使用正则表达式了。<br>JavaScript有两种方式创建一个正则表达式：<br>第一种方式是直接通过/正则表达式/写出来，第二种方式是通过new RegExp(‘正则表达式’)创建一个RegExp对象。<br>两种写法是一样的：<br>var re1 = /ABC-001/;<br>var re2 = new RegExp(‘ABC\-001’);</p>
<p>re1; // /ABC-001/<br>re2; // /ABC-001/<br>注意，如果使用第二种写法，因为字符串的转义问题，字符串的两个\实际上是一个\。<br>先看看如何判断正则表达式是否匹配：<br>var re = /^\d{3}-\d{3,8}$/;<br>re.test(‘010-12345’); //true<br>re.test(‘010-1234x’); //false<br>re.test(‘010 12345’); //false<br>RegExp对象的test()方法用于测试给定的字符串是否符合条件。<br>切分字符串</p>
<p>用正则表达式切分字符串比用固定的字符更灵活，请看正常的切分代码：<br>‘a b   c’.split(‘ ‘); // [‘a’, ‘b’, ‘’, ‘’, ‘c’]<br>嗯，无法识别连续的空格，用正则表达式试试：<br>‘a b   c’.split(/\s+/); // [‘a’, ‘b’, ‘c’]<br>无论多少个空格都可以正常分割。加入,试试：<br>‘a,b, c  d’.split(/[\s\,]+/); // [‘a’, ‘b’, ‘c’, ‘d’]<br>再加入;试试：<br>‘a,b;; c  d’.split(/[\s\,\;]+/); // [‘a’, ‘b’, ‘c’, ‘d’]<br>如果用户输入了一组标签，下次记得用正则表达式来把不规范的输入转化成正确的数组。<br>分组</p>
<p>除了简单地判断是否匹配之外，正则表达式还有提取子串的强大功能。用()表示的就是要提取的分组（Group）。比如：<br>^(\d{3})-(\d{3,8})$分别定义了两个组，可以直接从匹配的字符串中提取出区号和本地号码：<br>var re = /^(\d{3})-(\d{3,8})$/;<br>re.exec(‘010-12345’); // [‘010-12345’, ‘010’, ‘12345’]<br>re.exec(‘010 12345’); // null<br>如果正则表达式中定义了组，就可以在RegExp对象上用exec()方法提取出子串来。<br>exec()方法在匹配成功后，会返回一个Array，第一个元素始终是原始字符串本身，后面的字符串表示匹配成功的子串。<br>exec()方法在匹配失败时返回null。<br>提取子串非常有用。来看一个更凶残的例子：<br>var re = /^(0[0-9]|1[0-9]|2[0-3]|[0-9])\:(0[0-9]|1[0-9]|2[0-9]|3[0-9]|4[0-9]|5[0-9]|[0-9])\:(0[0-9]|1[0-9]|2[0-9]|3[0-9]|4[0-9]|5[0-9]|[0-9])$/;<br>re.exec(‘19:05:30’); // [‘19:05:30’, ‘19’, ‘05’, ‘30’]<br>这个正则表达式可以直接识别合法的时间。但是有些时候，用正则表达式也无法做到完全验证，比如识别日期：<br>var re = /^(0[1-9]|1[0-2]|[0-9])-(0[1-9]|1[0-9]|2[0-9]|3[0-1]|[0-9])$/;<br>对于’2-30’，’4-31’这样的非法日期，用正则还是识别不了，或者说写出来非常困难，这时就需要程序配合识别了。<br>贪婪匹配</p>
<p>需要特别指出的是，正则匹配默认是贪婪匹配，也就是匹配尽可能多的字符。举例如下，匹配出数字后面的0：<br>var re = /^(\d+)(0<em>)$/;<br>re.exec(‘102300’); // [‘102300’, ‘102300’, ‘’]<br>由于\d+采用贪婪匹配，直接把后面的0全部匹配了，结果0</em>只能匹配空字符串了。<br>必须让\d+采用非贪婪匹配（也就是尽可能少匹配），才能把后面的0匹配出来，加个?就可以让\d+采用非贪婪匹配：<br>var re = /^(\d+?)(0*)$/;<br>re.exec(‘102300’); // [‘102300’, ‘1023’, ‘00’]<br>全局搜索</p>
<p>JavaScript的正则表达式还有几个特殊的标志，最常用的是g，表示全局匹配：<br>var r1 = /test/g;<br>// 等价于:var r2 = new RegExp(‘test’, ‘g’);<br>全局匹配可以多次执行exec()方法来搜索一个匹配的字符串。当我们指定g标志后，每次运行exec()，正则表达式本身会更新lastIndex属性，表示上次匹配到的最后索引：<br>var s = ‘JavaScript, VBScript, JScript and ECMAScript’;<br>var re=/[a-zA-Z]+Script/g;</p>
<p>// 使用全局匹配:<br>re.exec(s); // [‘JavaScript’]<br>re.lastIndex; // 10</p>
<p>re.exec(s); // [‘VBScript’]<br>re.lastIndex; // 20</p>
<p>re.exec(s); // [‘JScript’]<br>re.lastIndex; // 29</p>
<p>re.exec(s); // [‘ECMAScript’]<br>re.lastIndex; // 44</p>
<p>re.exec(s); // null，直到结束仍没有匹配到<br>全局匹配类似搜索，因此不能使用/^…$/，那样只会最多匹配一次。<br>正则表达式还可以指定i标志，表示忽略大小写，m标志，表示执行多行匹配。<br>小结</p>
<p>正则表达式非常强大，要在短短的一节里讲完是不可能的。要讲清楚正则的所有内容，可以写一本厚厚的书了。如果你经常遇到正则表达式的问题，你可能需要一本正则表达式的参考书。<br>练习</p>
<p>请尝试写一个验证Email地址的正则表达式。版本一应该可以验证出类似的Email：<br>‘use strict’;<br>// 测试:<br>var<br>    i,<br>    success = true,<br>    should_pass = [‘someone@gmail.com’, ‘bill.gates@microsoft.com’, ‘tom@voyager.org’, ‘bob2015@163.com’],<br>    should_fail = [‘test#gmail.com’, ‘bill@microsoft’, ‘bill%gates@ms.com’, ‘@voyager.org’];<br>for (i = 0; i &lt; should_pass.length; i++) {<br>    if (!re.test(should_pass[i])) {<br>        alert(‘测试失败: ‘ + should_pass[i]);<br>        success = false;<br>        break;<br>    }<br>}<br>for (i = 0; i &lt; should_fail.length; i++) {<br>    if (re.test(should_fail[i])) {<br>        alert(‘测试失败: ‘ + should_fail[i]);<br>        success = false;<br>        break;<br>    }<br>}<br>if (success) {<br>    alert(‘测试通过!’);<br>}<br>版本二可以验证并提取出带名字的Email地址：<br>‘use strict’;<br>// 测试:<br>var r = re.exec(‘<tom paris=""> tom@voyager.org’);<br>if (r === null || r.toString() !== [‘<tom paris=""> tom@voyager.org’, ‘Tom Paris’, ‘tom@voyager.org’].toString()) {<br>    alert(‘测试失败!’);<br>}<br>else {<br>    alert(‘测试成功!’);<br>}</tom></tom></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 菜菜
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>